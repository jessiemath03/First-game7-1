<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Jessie Math - ä¸‰å¹´ç´š å…¬æ–¤èˆ‡å…¬å…‹ </title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --primary: #ffb703;
      --primary-dark: #fb8500;
      --bg: #fef6e9;
      --text: #222222;
      --accent: #219ebc;
      --danger: #e63946;
      --success: #2a9d8f;
      --card: #ffffff;
      --shadow: 0 4px 12px rgba(0,0,0,0.12);
      --radius-lg: 18px;
      --radius-md: 12px;
      --radius-sm: 8px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Noto Sans TC", system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      justify-content: center;
      min-height: 100vh;
    }

    .page {
      width: 100%;
      max-width: 1200px; /* âœ… æ›´å¯¬ï¼šé¡Œç›®å€æ›´èˆ’å±• */
      padding: 12px 16px 24px;
    }

    .hero-bar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
      gap: 12px;
    }

    .brand-area {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-logo-wrap {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      background: var(--primary);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0,0,0,0.18);
      flex-shrink: 0;
    }

    .brand-logo-wrap img {
      width: 90%;
      height: auto;
      display: block;
    }

    .brand-text {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .brand-title {
      font-weight: 800;
      font-size: 1.1rem;
      letter-spacing: 0.04em;
    }

    .brand-subtitle {
      font-size: 0.78rem;
      color: #555;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .nav-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      border: none;
      background: #ffffff;
      color: #333;
      font-size: 0.82rem;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.12);
      text-decoration: none;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.12s ease;
    }

    .nav-btn span.icon { font-size: 1rem; }

    .nav-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 3px 10px rgba(0,0,0,0.18);
      background: #fff9e6;
    }

    .nav-btn:active {
      transform: translateY(0);
      box-shadow: 0 1px 4px rgba(0,0,0,0.15);
    }

    .card {
      background: var(--card);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      padding: 20px 18px 18px;
    }

    .page-section { display: none; }
    .page-section.active { display: block; }

    h1, h2, h3 { margin: 0; }
    h1 { font-size: 1.4rem; margin-bottom: 4px; }
    h2 { font-size: 1.2rem; margin-bottom: 10px; }
    h3 { font-size: 1.05rem; margin-bottom: 8px; }

    p {
      margin: 0 0 8px;
      font-size: 0.9rem;
      line-height: 1.6;
    }

    .highlight {
      color: var(--primary-dark);
      font-weight: 700;
    }

    .field-group { margin-top: 10px; margin-bottom: 8px; }

    label {
      display: block;
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    input[type="text"], select {
      width: 100%;
      padding: 8px 10px;
      border-radius: var(--radius-sm);
      border: 1px solid #ddd;
      font-size: 0.9rem;
    }

    input[type="text"]:focus, select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 2px rgba(33,158,188,0.15);
    }

    .btn-row {
      margin-top: 14px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 8px 16px;
      font-size: 0.9rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.12s ease;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: #fff;
      box-shadow: 0 4px 10px rgba(251,133,0,0.45);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 12px rgba(251,133,0,0.6);
    }

    .btn-primary:active {
      transform: translateY(0);
      box-shadow: 0 2px 6px rgba(251,133,0,0.4);
    }

    .btn-ghost {
      background: #fffaf0;
      color: #444;
      box-shadow: 0 2px 6px rgba(0,0,0,0.12);
    }

    .btn-ghost:hover { background: #fff1cd; }

    .btn-danger {
      background: #ffe5e8;
      color: var(--danger);
      box-shadow: 0 2px 6px rgba(230,57,70,0.15);
    }

    .btn-danger:hover { background: #ffd3da; }

    .btn-outline {
      background: transparent;
      border: 1px solid #ddd;
      color: #444;
    }

    .btn-outline:hover { background: #fff7e3; }

    .btn[disabled] {
      opacity: 0.5;
      cursor: not-allowed;
      box-shadow: none;
      transform: none;
    }

    .intro-grid {
      display: grid;
      grid-template-columns: minmax(0,1.4fr) minmax(0,1fr);
      gap: 14px;
      margin-top: 10px;
      align-items: flex-start;
    }

    .intro-box {
      background: #fff9ec;
      border-radius: var(--radius-md);
      padding: 10px 12px;
      border: 1px dashed rgba(251,133,0,0.5);
    }

    .intro-list {
      margin: 0;
      padding-left: 18px;
      font-size: 0.86rem;
    }

    .intro-list li { margin-bottom: 4px; }

    .tag-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .tag {
      padding: 3px 8px;
      border-radius: 999px;
      font-size: 0.7rem;
      background: #fff2c6;
      color: #8b5a00;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: minmax(0,2fr) minmax(0,1.6fr);
      gap: 16px;
      margin-top: 8px;
    }

    .section-box {
      background: #fffaf4;
      border-radius: var(--radius-md);
      padding: 10px 12px;
      border: 1px solid #f3e0b8;
    }

    .pill-title {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 0.85rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: #fff1cd;
      margin-bottom: 6px;
    }

    .level-list, .speed-list {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 6px;
    }

    .chip {
      padding: 6px 10px;
      border-radius: 999px;
      font-size: 0.84rem;
      cursor: pointer;
      border: 1px solid #f0d7a1;
      background: #fffdf6;
    }

    .chip.active {
      background: var(--primary);
      border-color: var(--primary-dark);
      color: #fff;
      box-shadow: 0 2px 8px rgba(251,133,0,0.5);
    }

    .chip span.badge {
      font-size: 0.7rem;
      padding: 0 6px;
      border-radius: 999px;
      background: rgba(0,0,0,0.12);
    }

    .leaderboard-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
      margin-top: 6px;
    }

    .leaderboard-table th,
    .leaderboard-table td {
      padding: 4px 6px;
      text-align: left;
      border-bottom: 1px solid #f1e1b9;
    }

    .leaderboard-table th { background: #fff4d6; }

    .rank-tag {
      display: inline-block;
      padding: 2px 6px;
      border-radius: 999px;
      font-size: 0.72rem;
      background: #ffe9b5;
    }

    .rank-1 { background: #ffdf6b; }
    .rank-2 { background: #e0e6f8; }
    .rank-3 { background: #ffd9b5; }

    .game-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 12px;
    }

    .status-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      font-size: 0.9rem; /* âœ… å¾®æ”¾å¤§ç‹€æ…‹åˆ— */
    }

    .status-pill {
      padding: 6px 10px;  /* âœ… è®“ç‹€æ…‹æ›´å¥½é»æ“Šèˆ‡å¯è®€ */
      border-radius: 999px;
      background: #fffaf0;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .status-label { opacity: 0.7; }
    .status-value { font-weight: 800; }

    .game-top-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .btn-small { padding: 8px 12px; font-size: 0.9rem; } /* âœ… è®“æŒ‰éˆ•ä¸é‚£éº¼è¿·ä½  */

    /* âœ… éŠæˆ²ï¼šå–®æ¬„ + ä¾æ¯”ä¾‹æ”¾å¤§ã€Œé¡Œç›®å€/å›ç­”å€ã€ */
    .game-body {
      display: grid;
      grid-template-columns: minmax(0,1fr);
      gap: 14px;
      margin-top: 6px;
    }

    .question-card {
      border-radius: var(--radius-md);
      background: #fffaf6;
      border: 1px solid #f2ddbc;
      display: flex;
      flex-direction: column;
      gap: 12px;

      /* âœ… æ”¾å¤§æ¯”ä¾‹ï¼šæ•´é«”å…§è·èˆ‡æœ€å°é«˜åº¦æå‡ */
      padding: clamp(16px, 2.2vw, 26px) clamp(16px, 2.4vw, 30px);
      min-height: min(72vh, 640px);
    }

    .question-title-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .question-title-row h3{
      font-size: clamp(1.05rem, 1.2vw, 1.25rem);
      letter-spacing: 0.02em;
    }

    .question-main {
      /* âœ… é¡Œç›®å­—é«”ä¾æ¯”ä¾‹æ”¾å¤§ */
      font-size: clamp(1.12rem, 1.7vw, 1.5rem);
      line-height: 1.75;
      min-height: 120px; /* âœ… é¡Œç›®å€æ›´å¤§ï¼šä¸æœƒæ“ æˆä¸€åœ˜ */
      padding: 10px 12px;
      background: #fffefb;
      border: 1px solid rgba(242, 221, 188, 0.9);
      border-radius: 12px;
    }

    .answer-row {
      display: grid;
      grid-template-columns: minmax(220px, 1fr) auto; /* âœ… è¼¸å…¥æ¡†åƒå¤§ä¸€é» */
      gap: 12px;
      align-items: center;
      margin-top: 6px;
    }

    .answer-row input[type="text"] {
      font-size: clamp(1.08rem, 1.5vw, 1.35rem);
      padding: 14px 14px;
      border-radius: 12px;
      border: 1px solid #ddd;
    }

    .answer-row .btn {
      font-size: clamp(1.0rem, 1.2vw, 1.15rem);
      padding: 12px 18px;
      border-radius: 14px;
    }

    .feedback-text {
      font-size: clamp(1.02rem, 1.25vw, 1.18rem);
      margin-top: 4px;
      min-height: 28px;
      font-weight: 700;
    }

    .feedback-correct { color: var(--success); }
    .feedback-wrong { color: var(--danger); }

    .tip-text {
      font-size: clamp(0.92rem, 1.05vw, 1.02rem);
      color: #666;
      margin-top: 2px;
      min-height: 18px;
    }

    .overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.45);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 50;
      padding: 16px;
    }

    .overlay.visible { display: flex; }

    .overlay-card {
      max-width: 440px;
      width: 100%;
      background: #ffffff;
      border-radius: var(--radius-lg);
      box-shadow: 0 10px 30px rgba(0,0,0,0.25);
      padding: 18px 16px 14px;
    }

    .overlay-title {
      font-size: 1.1rem;
      margin-bottom: 4px;
    }

    .overlay-sub {
      font-size: 0.86rem;
      color: #555;
      margin-bottom: 8px;
    }

    .overlay-btn-row {
      margin-top: 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      justify-content: flex-end;
    }

    .pause-mask { text-align: center; }
    .pause-icon { font-size: 2.4rem; margin-bottom: 4px; }

    @media (max-width: 768px) {
      .hero-bar { flex-direction: row; align-items: flex-start; }
      .intro-grid, .menu-grid { grid-template-columns: minmax(0,1fr); }
      .card { padding: 16px 12px 14px; }
      .game-header { flex-direction: column; align-items: stretch; }
      .game-top-buttons { justify-content: flex-end; }

      .question-card{
        min-height: min(74vh, 720px);
      }

      .answer-row{
        grid-template-columns: minmax(0,1fr);
      }
      .answer-row .btn{
        width: 100%;
        justify-content: center;
      }
    }

    @media (max-width: 480px) {
      .brand-title { font-size: 1rem; }
      .page { padding: 10px; }
      .status-group { font-size: 0.88rem; }
    }
  </style>
</head>
<body>
  <main class="page">
    <header class="hero-bar">
      <div class="brand-area">
        <div class="brand-logo-wrap">
          <img src="JESSIEMATH-Q.png" alt="Jessie Math Logo" />
        </div>
        <div class="brand-text">
          <div class="brand-title">Jessie Math</div>
          <div class="brand-subtitle">ä¸‰å¹´ç´šï½œä¸»é¡Œä¸ƒï¼šå…¬æ–¤èˆ‡å…¬å…‹</div>
        </div>
      </div>

      <nav class="nav-links">
        <a class="nav-btn" href="https://jessiemath0703-chu.github.io/website2/" target="_blank" rel="noopener">
          <span class="icon">ğŸ </span><span>é¦–é </span>
        </a>
        <a class="nav-btn" href="https://jessiemath0703-chu.github.io/Game-Lobby/" target="_blank" rel="noopener">
          <span class="icon">ğŸ®</span><span>éŠæˆ²å¤§å»³</span>
        </a>
        <a class="nav-btn" href="https://jessiemath0703-chu.github.io/Game-Lobby/#g3-u7" target="_blank" rel="noopener">
          <span class="icon">â†©ï¸</span><span>ä¸‰å¹´ç´šå…¬æ–¤èˆ‡å…¬å…‹</span>
        </a>
      </nav>
    </header>

    <section class="card">
      <!-- ç¬¬ 1 é  -->
      <section id="page-1" class="page-section active">
        <h1>å…ˆè·Ÿ æ·æ èªªä½ æ˜¯èª°å§ï¼</h1>
        <p>è«‹è¼¸å…¥ç©å®¶åç¨±ï¼Œçœ‹çœ‹èª°èƒ½åœ¨ <span class="highlight">60 ç§’</span> å…§æ‹¿åˆ°æœ€å¤šæ˜Ÿæ˜Ÿå’Œé«˜åˆ†ã€‚</p>

        <div class="intro-grid">
          <div>
            <div class="intro-box">
              <h3>éŠæˆ²èªªæ˜</h3>
              <ul class="intro-list">
                <li>æ¯ä¸€å±€æ™‚é–“ï¼š<span class="highlight">60 ç§’</span>ã€‚</li>
                <li>ç­”å°ï¼š+5 ç§’ï¼Œå¾—åˆ†åŠ ä¸Š Combo å€ç‡ï¼Œä¸¦é¡¯ç¤ºå›é¥‹ã€‚</li>
                <li>ç­”éŒ¯ï¼šâˆ’5 ç§’ï¼Œæœƒé¡¯ç¤ºã€Œæ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š_____ã€ã€‚</li>
                <li>æœ¬å±€çµæŸå¾Œå¯é¸æ“‡è¦ä¸è¦å¯«å…¥æ’è¡Œæ¦œï¼ˆé¿å…æ´—æ¦œï¼‰ã€‚</li>
              </ul>
              <div class="tag-row">
                <span class="tag">å…¬æ–¤ kg</span>
                <span class="tag">å…¬å…‹ g</span>
                <span class="tag">å–®ä½æ›ç®—</span>
                <span class="tag">é‡é‡ä¼°æ¸¬</span>
              </div>
            </div>
          </div>
          <div>
            <div class="field-group">
              <label for="playerName">ç©å®¶åç¨±ï¼ˆå¿…å¡«ï¼‰</label>
              <input id="playerName" type="text" placeholder="ä¾‹å¦‚ï¼šé‡é‡å°é”äººã€å°å°ç§¤é‡å¸«â€¦" />
            </div>
            <p class="tip-text">
              å°æé†’ï¼šæ’è¡Œæ¦œæœƒé¡¯ç¤ºä½ çš„åå­—èˆ‡åˆ†æ•¸ï¼Œè«‹å–ä¸€å€‹è‡ªå·±å–œæ­¡åˆå®‰å…¨çš„æš±ç¨±ã€‚
            </p>
            <div class="btn-row">
              <button id="btnStartFromIntro" class="btn btn-primary">
                é€²å…¥é—œå¡é¸å–®
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- ç¬¬ 2 é  -->
      <section id="page-2" class="page-section">
        <h2>é¸æ“‡é—œå¡èˆ‡é€Ÿåº¦</h2>
        <p>å…ˆé¸é—œå¡ï¼Œå†é¸é€Ÿåº¦ï¼Œæº–å‚™å¥½å°±é–‹å§‹æŒ‘æˆ°å…¬æ–¤èˆ‡å…¬å…‹å§ã€‚</p>

        <div class="menu-grid">
          <div class="section-box">
            <div class="pill-title">
              <span>ğŸ“š é—œå¡ä¸»é¸å–®</span>
            </div>
            <p class="tip-text">
              å„é—œå¡å°æ‡‰æ•™æå…§å®¹ï¼šèªè­˜å…¬æ–¤ã€å…¬å…‹ã€å¹¾å…¬æ–¤å¹¾å…¬å…‹ã€æ›ç®—èˆ‡æ¯”è¼ƒã€è¨ˆç®—èˆ‡ä¼°æ¸¬ã€‚
            </p>
            <div class="level-list" id="levelList"></div>

            <div style="margin-top:10px;">
              <div class="pill-title">
                <span>âš¡ é€Ÿåº¦ / é›£åº¦</span>
              </div>
              <p class="tip-text">
                é€Ÿåº¦è¶Šå¿«ï¼Œç­”å°å¾—åˆ†è¶Šå¤šï¼›ä½†æ™‚é–“ä¹Ÿæœƒå£“åŠ›æ›´å¤§ã€‚
              </p>
              <div class="speed-list" id="speedList"></div>
            </div>

            <div class="btn-row">
              <button id="btnGoGame" class="btn btn-primary">
                é–‹å§‹æœ¬å±€
              </button>
              <button id="btnBackToIntro" class="btn btn-ghost">
                å›è¼¸å…¥åå­—é 
              </button>
            </div>
          </div>

          <div class="section-box">
            <div class="pill-title">
              <span>ğŸ… æ’è¡Œæ¦œï¼ˆæœ¬æ©Ÿï¼‰</span>
            </div>
            <p class="tip-text">
              åªæœ‰å®Œæˆä¸€å±€å¾Œé¸æ“‡ã€Œå„²å­˜æˆç¸¾ã€æ‰æœƒå¯«å…¥æ’è¡Œæ¦œï¼Œå›ä¸»é¸å–®ä¸æœƒè¨˜éŒ„ï¼Œé¿å…æ´—æ¦œã€‚
            </p>
            <table class="leaderboard-table" id="leaderboardTable">
              <thead>
                <tr>
                  <th>åæ¬¡</th>
                  <th>ç©å®¶</th>
                  <th>é—œå¡</th>
                  <th>é€Ÿåº¦</th>
                  <th>åˆ†æ•¸</th>
                  <th>â˜…</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </section>

      <!-- ç¬¬ 3 é  -->
      <section id="page-3" class="page-section">
        <div class="game-header">
          <div class="status-group">
            <div class="status-pill">
              <span class="status-label">ç©å®¶ï¼š</span>
              <span class="status-value" id="statusPlayerName">ï¼</span>
            </div>
            <div class="status-pill">
              <span class="status-label">é—œå¡ï¼š</span>
              <span class="status-value" id="statusLevel">ï¼</span>
            </div>
            <div class="status-pill">
              <span class="status-label">é€Ÿåº¦ï¼š</span>
              <span class="status-value" id="statusSpeed">ï¼</span>
            </div>
            <div class="status-pill">
              â±ï¸ <span class="status-value" id="statusTime">60</span>s
            </div>
            <div class="status-pill">
              ğŸ§  åˆ†æ•¸ï¼š<span class="status-value" id="statusScore">0</span>
            </div>
            <div class="status-pill">
              ğŸ”¥ Comboï¼š<span class="status-value" id="statusCombo">x1</span>
            </div>
          </div>
          <div class="game-top-buttons">
            <button id="btnRestart" class="btn btn-ghost btn-small">é‡æ–°æœ¬å±€</button>
            <button id="btnPause" class="btn btn-outline btn-small">æš«åœ</button>
            <button id="btnBackMenuFromGame" class="btn btn-danger btn-small">å›é—œå¡ä¸»é¸å–®</button>
          </div>
        </div>

        <div class="game-body">
          <div class="question-card">
            <div class="question-title-row">
              <h3>è§£é¡Œå€</h3>
              <span id="questionTag" class="tag">é¡Œç›®</span>
            </div>

            <div class="question-main" id="questionText">ï¼ˆæŒ‰ã€Œé–‹å§‹æœ¬å±€ã€å¾Œæœƒå‡ºé¡Œï¼‰</div>

            <div class="answer-row">
              <input id="answerInput" type="text" placeholder="è¼¸å…¥ç­”æ¡ˆï¼Œä¾‹å¦‚ï¼š1500ã€3ã€>â€¦" />
              <button id="btnSubmit" class="btn btn-primary">ä½œç­”</button>
            </div>

            <div class="feedback-text" id="feedbackText"></div>
            <div class="tip-text" id="tipText"></div>
          </div>
        </div>
      </section>
    </section>

    <!-- æš«åœ -->
    <div id="pauseOverlay" class="overlay">
      <div class="overlay-card pause-mask">
        <div class="pause-icon">â¸ï¸</div>
        <div class="overlay-title">æš«åœä¸­</div>
        <p class="overlay-sub">æ™‚é–“å·²æš«åœï¼Œé¡Œç›®é–ä½ã€‚æº–å‚™å¥½äº†å†ç¹¼çºŒæŒ‘æˆ°ï¼</p>
        <div class="overlay-btn-row" style="justify-content:center;">
          <button id="btnResumeFromPause" class="btn btn-primary">ç¹¼çºŒéŠæˆ²</button>
        </div>
      </div>
    </div>

    <!-- çµç®— -->
    <div id="resultOverlay" class="overlay">
      <div class="overlay-card">
        <div class="overlay-title">æœ¬å±€çµæŸï¼</div>
        <p class="overlay-sub">ä¸€èµ·çœ‹çœ‹é€™ä¸€å±€ä½ çš„è¡¨ç¾å¦‚ä½•å§ã€‚</p>
        <p style="font-size:0.9rem;margin-bottom:6px;">ç©å®¶ï¼š<span class="highlight" id="resultPlayerName">ï¼</span></p>
        <p style="font-size:0.9rem;margin-bottom:6px;">é—œå¡ï¼š<span id="resultLevelText">ï¼</span>ï½œé€Ÿåº¦ï¼š<span id="resultSpeedText">ï¼</span></p>
        <p style="font-size:0.9rem;margin-bottom:6px;">åˆ†æ•¸ï¼š<span class="highlight" id="resultScore">0</span> åˆ†</p>
        <p style="font-size:0.9rem;margin-bottom:6px;">æ˜Ÿç­‰ï¼š<span id="resultStars">â˜†â˜†â˜†</span></p>
        <p class="tip-text">æ˜Ÿç­‰èªªæ˜ï¼šåˆ†æ•¸è¼ƒé«˜å¯æ‹¿åˆ° â˜…â˜…â˜…ï¼Œä¸­ç­‰ â˜…â˜…ï¼ŒåŸºç¤ â˜…ã€‚</p>
        <div class="overlay-btn-row">
          <button id="btnSaveScore" class="btn btn-primary">å„²å­˜æˆç¸¾åˆ°æ’è¡Œæ¦œ</button>
          <button id="btnCloseResult" class="btn btn-ghost">ä¸å„²å­˜ï¼Œåªå›ä¸»é¸å–®</button>
        </div>
      </div>
    </div>
  </main>

  <script>
    const state = {
      playerName: "",
      level: 1,
      speed: "normal",
      score: 0,
      timeLeft: 60,
      combo: 0,
      comboMultiplier: 1,
      timerId: null,
      isPlaying: false,
      isPaused: false,
      isLocking: false,
      currentQuestion: null,
      pendingScore: null,
      feedbackDelayMs: 1200
    };

    const levelInfo = [
      { id: 1, name: "ç¬¬ 1 é—œ", desc: "èªè­˜å…¬æ–¤ï¼ˆéœ€è¦æ¨ç†ï¼‰" },
      { id: 2, name: "ç¬¬ 2 é—œ", desc: "èªè­˜å…¬å…‹ï¼ˆéœ€è¦æ¨ç†ï¼‰" },
      { id: 3, name: "ç¬¬ 3 é—œ", desc: "å¹¾å…¬æ–¤å¹¾å…¬å…‹" },
      { id: 4, name: "ç¬¬ 4 é—œ", desc: "æ›ç®—èˆ‡æ¯”è¼ƒ" },
      { id: 5, name: "ç¬¬ 5 é—œ", desc: "é‡é‡è¨ˆç®—èˆ‡ä¼°æ¸¬" }
    ];

    const speedInfo = [
      { id: "slow", label: "æ…¢é€Ÿ", desc: "ç¯€å¥è¼ƒæ…¢ï¼Œå¾—åˆ†è¼ƒä½ã€‚" },
      { id: "normal", label: "ä¸€èˆ¬", desc: "æ¨™æº–ç¯€å¥ã€‚" },
      { id: "fast", label: "åŠ é€Ÿ", desc: "ç¯€å¥è¼ƒå¿«ï¼Œå¾—åˆ†è¼ƒé«˜ã€‚" }
    ];

    const page1 = document.getElementById("page-1");
    const page2 = document.getElementById("page-2");
    const page3 = document.getElementById("page-3");

    const inputPlayerName = document.getElementById("playerName");
    const btnStartFromIntro = document.getElementById("btnStartFromIntro");

    const levelListEl = document.getElementById("levelList");
    const speedListEl = document.getElementById("speedList");
    const btnGoGame = document.getElementById("btnGoGame");
    const btnBackToIntro = document.getElementById("btnBackToIntro");

    const statusPlayerName = document.getElementById("statusPlayerName");
    const statusLevel = document.getElementById("statusLevel");
    const statusSpeed = document.getElementById("statusSpeed");
    const statusTime = document.getElementById("statusTime");
    const statusScore = document.getElementById("statusScore");
    const statusCombo = document.getElementById("statusCombo");

    const questionText = document.getElementById("questionText");
    const questionTag = document.getElementById("questionTag");
    const answerInput = document.getElementById("answerInput");
    const btnSubmit = document.getElementById("btnSubmit");
    const feedbackText = document.getElementById("feedbackText");
    const tipText = document.getElementById("tipText");

    const btnRestart = document.getElementById("btnRestart");
    const btnPause = document.getElementById("btnPause");
    const btnBackMenuFromGame = document.getElementById("btnBackMenuFromGame");

    const pauseOverlay = document.getElementById("pauseOverlay");
    const btnResumeFromPause = document.getElementById("btnResumeFromPause");

    const resultOverlay = document.getElementById("resultOverlay");
    const resultPlayerName = document.getElementById("resultPlayerName");
    const resultLevelText = document.getElementById("resultLevelText");
    const resultSpeedText = document.getElementById("resultSpeedText");
    const resultScore = document.getElementById("resultScore");
    const resultStars = document.getElementById("resultStars");
    const btnSaveScore = document.getElementById("btnSaveScore");
    const btnCloseResult = document.getElementById("btnCloseResult");

    const leaderboardTable = document.getElementById("leaderboardTable").querySelector("tbody");

    function showPage(n) {
      [page1, page2, page3].forEach((p, i) => p.classList.toggle("active", i === n - 1));
    }

    function initLevelChips() {
      levelListEl.innerHTML = "";
      levelInfo.forEach(lv => {
        const div = document.createElement("div");
        div.className = "chip" + (lv.id === state.level ? " active" : "");
        div.dataset.level = lv.id;
        div.innerHTML = `<span>${lv.name}</span><span class="badge">${lv.desc}</span>`;
        div.addEventListener("click", () => { state.level = lv.id; updateLevelChipActive(); });
        levelListEl.appendChild(div);
      });
    }

    function updateLevelChipActive() {
      levelListEl.querySelectorAll(".chip").forEach(chip => {
        chip.classList.toggle("active", Number(chip.dataset.level) === state.level);
      });
    }

    function initSpeedChips() {
      speedListEl.innerHTML = "";
      speedInfo.forEach(sp => {
        const div = document.createElement("div");
        div.className = "chip" + (sp.id === state.speed ? " active" : "");
        div.dataset.speed = sp.id;
        div.innerHTML = `<span>${sp.label}</span><span class="badge">${sp.desc}</span>`;
        div.addEventListener("click", () => { state.speed = sp.id; updateSpeedChipActive(); });
        speedListEl.appendChild(div);
      });
    }

    function updateSpeedChipActive() {
      speedListEl.querySelectorAll(".chip").forEach(chip => {
        chip.classList.toggle("active", chip.dataset.speed === state.speed);
      });
    }

    function loadLeaderboard() {
      try {
        const raw = localStorage.getItem("jessie_kg_g_feedback2_leaderboard");
        if (!raw) return [];
        const arr = JSON.parse(raw);
        return Array.isArray(arr) ? arr : [];
      } catch (e) { return []; }
    }

    function saveLeaderboard(data) {
      localStorage.setItem("jessie_kg_g_feedback2_leaderboard", JSON.stringify(data));
    }

    function renderLeaderboard() {
      const rows = loadLeaderboard().sort((a, b) => b.score - a.score).slice(0, 10);
      leaderboardTable.innerHTML = "";
      if (rows.length === 0) {
        const tr = document.createElement("tr");
        const td = document.createElement("td");
        td.colSpan = 6;
        td.textContent = "ç›®å‰é‚„æ²’æœ‰æˆç¸¾ï¼Œå¿«ä¾†ç•¶ç¬¬ä¸€å€‹ä¸Šæ¦œçš„å°é”äººï¼";
        tr.appendChild(td);
        leaderboardTable.appendChild(tr);
        return;
      }
      rows.forEach((r, idx) => {
        const tr = document.createElement("tr");

        const rankTd = document.createElement("td");
        const rankSpan = document.createElement("span");
        rankSpan.className = "rank-tag";
        if (idx === 0) rankSpan.classList.add("rank-1");
        if (idx === 1) rankSpan.classList.add("rank-2");
        if (idx === 2) rankSpan.classList.add("rank-3");
        rankSpan.textContent = idx + 1;
        rankTd.appendChild(rankSpan);

        const nameTd = document.createElement("td"); nameTd.textContent = r.name;
        const levelTd = document.createElement("td"); levelTd.textContent = `ç¬¬ ${r.level} é—œ`;
        const speedTd = document.createElement("td"); speedTd.textContent = r.speedLabel;
        const scoreTd = document.createElement("td"); scoreTd.textContent = r.score;
        const starTd = document.createElement("td"); starTd.textContent = r.stars;

        tr.appendChild(rankTd);
        tr.appendChild(nameTd);
        tr.appendChild(levelTd);
        tr.appendChild(speedTd);
        tr.appendChild(scoreTd);
        tr.appendChild(starTd);
        leaderboardTable.appendChild(tr);
      });
    }

    function addScoreToLeaderboard(pending) {
      if (!pending) return;
      const list = loadLeaderboard();
      list.push(pending);
      saveLeaderboard(list);
      renderLeaderboard();
    }

    function setAnswerLock(isLocked) {
      state.isLocking = isLocked;
      answerInput.disabled = isLocked;
      btnSubmit.disabled = isLocked;
    }

    function updateStatusTexts() {
      statusPlayerName.textContent = state.playerName || "ï¼";
      const lv = levelInfo.find(l => l.id === state.level);
      statusLevel.textContent = lv ? lv.name : "ï¼";
      const sp = speedInfo.find(s => s.id === state.speed);
      statusSpeed.textContent = sp ? sp.label : "ï¼";
      statusTime.textContent = state.timeLeft;
      statusScore.textContent = state.score;
      statusCombo.textContent = `x${state.comboMultiplier}`;
    }

    function computeStars(score) {
      if (score >= 1500) return "â˜…â˜…â˜…";
      if (score >= 800) return "â˜…â˜…";
      if (score > 0) return "â˜…";
      return "â˜†â˜†â˜†";
    }

    function randomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    function generateQuestion() {
      const lv = state.level;
      const q = { text: "", answer: "", tag: "", tip: "" };

      if (lv === 1) {
        const perKg = randomInt(2, 4);
        const bags = randomInt(2, 5);
        const total = perKg * bags;
        q.text = `æ¯è¢‹ç±³é‡ ${perKg} å…¬æ–¤ï¼Œä¸€å…± ${bags} è¢‹ï¼Œç¸½å…±å¤§ç´„å¹¾å…¬æ–¤ï¼Ÿï¼ˆåªå¡«ã€Œå…¬æ–¤ã€æ•¸å­—ï¼‰`;
        q.answer = String(total);
        q.tag = "èªè­˜å…¬æ–¤";
        q.tip = "æŠŠæ¯è¢‹çš„é‡é‡é‡è¤‡ç›¸åŠ ï¼Œå°±æ˜¯ç¸½å…¬æ–¤æ•¸ã€‚";
      } else if (lv === 2) {
        const base = randomInt(100, 400);
        const inc = [50, 80, 100][randomInt(0,2)];
        const times = randomInt(2, 4);
        const total = base + inc * times;
        const mode = randomInt(1,2);
        if (mode === 1) {
          q.text = `ä¸€åŒ…ç³–æœé‡ ${base} å…¬å…‹ï¼Œé˜¿å§¨åˆå¤šæ”¾äº† ${times} æ¬¡ï¼Œæ¯æ¬¡åŠ  ${inc} å…¬å…‹ï¼Œæœ€å¾Œå¤§ç´„å¹¾å…¬å…‹ï¼Ÿ`;
          q.tip = "å…ˆç®—ã€Œå¤šæ”¾äº†å¹¾å…¬å…‹ã€ï¼Œå†åŠ å›åŸæœ¬çš„é‡é‡ã€‚";
        } else {
          q.text = `ä¸€é¡†éºµåŒ…é‡ ${base} å…¬å…‹ï¼Œå¦å¤–ä¸€é¡†å¤š ${inc * times} å…¬å…‹ï¼Œè¼ƒé‡çš„é‚£é¡†å¤§ç´„å¹¾å…¬å…‹ï¼Ÿ`;
          q.tip = "åŸæœ¬çš„é‡é‡å†åŠ ä¸Šã€Œå¤šå‡ºä¾†çš„å…¬å…‹ã€ã€‚";
        }
        q.answer = String(total);
        q.tag = "èªè­˜å…¬å…‹";
      } else if (lv === 3) {
        const kg = randomInt(1, 4);
        const g = [100,200,300,400,500,600,700,800,900][randomInt(0,8)];
        const totalG = kg * 1000 + g;
        q.text = `ä¸€å€‹ç®±å­é‡ ${totalG} å…¬å…‹ï¼Œè«‹æŠŠå®ƒå¯«æˆã€Œå¹¾å…¬æ–¤å¹¾å…¬å…‹ã€ï¼Œä¾‹å¦‚ï¼š2 å…¬æ–¤ 300 å…¬å…‹ã€‚`;
        q.answer = `${kg}å…¬æ–¤${g}å…¬å…‹`;
        q.tag = "å¹¾å…¬æ–¤å¹¾å…¬å…‹";
        q.tip = "å…ˆçœ‹è£¡é¢æœ‰å¹¾å€‹ 1000 å…¬å…‹ï¼Œå°±æ˜¯å¹¾å…¬æ–¤ã€‚";
      } else if (lv === 4) {
        const baseKg = randomInt(1, 4);
        const diffG = [100,200,300][randomInt(0,2)];
        const aTotal = baseKg * 1000;
        const bTotal = aTotal + diffG * (Math.random() < 0.5 ? -1 : 1);
        const mode = randomInt(1,2);
        let formA, formB;
        if (mode === 1) {
          formA = `${baseKg} å…¬æ–¤`;
          formB = `æ¯” ${baseKg} å…¬æ–¤ ${bTotal > aTotal ? "é‡" : "è¼•"} ${Math.abs(diffG)} å…¬å…‹çš„ç®±å­`;
        } else {
          formA = `${aTotal} å…¬å…‹`;
          formB = `å¦ä¸€ç®±æ¯”å®ƒ ${bTotal > aTotal ? "å¤š" : "å°‘"} ${Math.abs(diffG)} å…¬å…‹`;
        }
        const comp = aTotal === bTotal ? "=" : (aTotal > bTotal ? ">" : "<");
        q.text = `${formA} å’Œ ${formB} æ¯”è¼ƒï¼Œå“ªä¸€å€‹æ¯”è¼ƒé‡ï¼Ÿè«‹å¡«ã€Œ>ã€ã€ã€Œ<ã€æˆ–ã€Œ=ã€ã€‚`;
        q.answer = comp;
        q.tag = "æ›ç®—èˆ‡æ¯”è¼ƒ";
        q.tip = "æƒ³åƒå…©å€‹éƒ½æ›æˆå…¬å…‹ï¼Œå†æ¯”è¼ƒå¤§å°ã€‚";
      } else {
        const mode = randomInt(1, 3);
        if (mode === 1) {
          const kg1 = randomInt(1, 3);
          const g1 = [0,200,500][randomInt(0,2)];
          const kg2 = randomInt(1, 2);
          const g2 = [0,200,500][randomInt(0,2)];
          const totalG = kg1*1000 + g1 + kg2*1000 + g2;
          q.text = `å°æ˜çš„è¡Œæé‡ ${kg1} å…¬æ–¤ ${g1} å…¬å…‹ï¼Œå°è¯çš„è¡Œææ¯”ä»–å¤š ${kg2} å…¬æ–¤ ${g2} å…¬å…‹ï¼Œå…©äººè¡Œæåˆèµ·ä¾†ç´„å¹¾å…¬å…‹ï¼Ÿ`;
          q.answer = String(totalG);
          q.tag = "é‡é‡è¨ˆç®—";
          q.tip = "å…ˆæŠŠå…©å€‹è¡Œæéƒ½æ›æˆå…¬å…‹ï¼Œå†ç›¸åŠ ã€‚";
        } else if (mode === 2) {
          const baseKg = randomInt(2, 5);
          const diffG = [200,300,500][randomInt(0,2)];
          const big = baseKg * 1000;
          const small = big - diffG;
          const askBig = Math.random() < 0.5;
          if (askBig) {
            q.text = `ä¸€ç®±è²¨ç‰©æ¯”å¦ä¸€ç®±é‡ ${diffG} å…¬å…‹ï¼Œè¼ƒè¼•çš„é‚£ç®±é‡ ${small} å…¬å…‹ï¼Œè¼ƒé‡çš„é‚£ç®±é‡å¹¾å…¬å…‹ï¼Ÿ`;
            q.answer = String(big);
            q.tip = "è¼ƒé‡ = è¼ƒè¼• + ç›¸å·®çš„å…¬å…‹ã€‚";
          } else {
            q.text = `å…©ç®±è²¨ç‰©ç›¸å·® ${diffG} å…¬å…‹ï¼Œå…¶ä¸­ä¸€ç®±æ˜¯ ${big} å…¬å…‹ï¼Œå¦ä¸€ç®±é‡å¹¾å…¬å…‹ï¼Ÿï¼ˆè«‹å¡«è¼ƒè¼•çš„é‚£ç®±ï¼‰`;
            q.answer = String(small);
            q.tip = "è¼ƒè¼• = è¼ƒé‡ âˆ’ ç›¸å·®çš„å…¬å…‹ã€‚";
          }
          q.tag = "é‡é‡è¨ˆç®—";
        } else {
          const kgOption = randomInt(1, 5);
          const lower = kgOption * 1000 - 150;
          const upper = kgOption * 1000 + 150;
          const real = randomInt(lower, upper);
          q.text = `ä¸€å€‹åŒ…è£¹é‡ç´„ ${real} å…¬å…‹ï¼Œå¤§ç´„æ˜¯å¹¾å…¬æ–¤æœ€åˆç†ï¼Ÿï¼ˆåªå¡«ã€Œå…¬æ–¤ã€æ•¸å­—ï¼Œä¾‹å¦‚ï¼š3ï¼‰`;
          q.answer = String(kgOption);
          q.tag = "é‡é‡ä¼°æ¸¬";
          q.tip = "æƒ³åƒæ¥è¿‘å“ªä¸€å€‹ 1000 å…¬å…‹ã€‚";
        }
      }
      return q;
    }

    function showQuestion() {
      const q = generateQuestion();
      state.currentQuestion = q;
      questionText.textContent = q.text;
      questionTag.textContent = q.tag;
      feedbackText.textContent = "";
      feedbackText.className = "feedback-text";
      tipText.textContent = q.tip || "";
      answerInput.value = "";
      setAnswerLock(false);
      answerInput.focus();
    }

    function normalize(str) {
      return str.replace(/\s+/g, "").replace(/å…¬å…‹/g, "g").replace(/å…¬æ–¤/g, "kg");
    }

    function checkAnswer() {
      if (!state.isPlaying || !state.currentQuestion || state.isPaused || state.isLocking) return;
      const userInput = answerInput.value.trim();
      if (!userInput) return;

      const q = state.currentQuestion;
      let correct = false;

      if (state.level === 3) {
        correct = normalize(userInput) === normalize(q.answer);
      } else if (state.level === 4) {
        correct = userInput.replace(/\s+/g, "") === q.answer;
      } else {
        const numUser = Number(userInput);
        const numAns = Number(q.answer);
        correct = !isNaN(numUser) && numUser === numAns;
      }

      if (correct) handleCorrectAnswer();
      else handleWrongAnswer();
    }

    function feedbackThenNext() {
      updateStatusTexts();
      setAnswerLock(true);
      setTimeout(() => {
        if (!state.isPlaying) return;
        if (state.timeLeft <= 0) endGame();
        else showQuestion();
      }, state.feedbackDelayMs);
    }

    function handleCorrectAnswer() {
      state.combo += 1;
      state.comboMultiplier = 1 + Math.floor(state.combo / 3);

      let base = 100;
      if (state.speed === "slow") base = 80;
      if (state.speed === "fast") base = 130;

      state.score += base * state.comboMultiplier;
      state.timeLeft = Math.min(state.timeLeft + 5, 120);

      feedbackText.textContent = "å›ç­”æ­£ç¢ºï¼å¤ªè®šäº† ğŸŒŸ";
      feedbackText.className = "feedback-text feedback-correct";
      tipText.textContent = "æ¼‚äº®ï¼åŒä¸€æ‹›ç¹¼çºŒæ‰“ä¸‹ä¸€é¡Œï½";
      feedbackThenNext();
    }

    function handleWrongAnswer() {
      state.combo = 0;
      state.comboMultiplier = 1;
      state.timeLeft = Math.max(state.timeLeft - 5, 0);

      feedbackText.textContent = `é€™é¡Œç­”éŒ¯äº† ğŸ˜µ æ­£ç¢ºç­”æ¡ˆæ˜¯ï¼š${state.currentQuestion.answer}`;
      feedbackText.className = "feedback-text feedback-wrong";
      tipText.textContent = state.currentQuestion.tip || "å¯ä»¥å…ˆæŠŠé‡é‡éƒ½æ›æˆå…¬å…‹å†ç®—ï¼Œæ¯”è¼ƒç©©ã€‚";
      feedbackThenNext();
    }

    function startTimer() {
      stopTimer();
      state.timerId = setInterval(() => {
        if (!state.isPlaying || state.isPaused) return;
        state.timeLeft -= 1;
        if (state.timeLeft <= 0) {
          state.timeLeft = 0;
          updateStatusTexts();
          endGame();
        } else updateStatusTexts();
      }, 1000);
    }

    function stopTimer() {
      if (state.timerId) { clearInterval(state.timerId); state.timerId = null; }
    }

    function resetGameValues() {
      state.score = 0;
      state.timeLeft = 60;
      state.combo = 0;
      state.comboMultiplier = 1;
      state.currentQuestion = null;
      state.isPlaying = false;
      state.isPaused = false;
      state.isLocking = false;
      state.pendingScore = null;
      stopTimer();
      updateStatusTexts();
      questionText.textContent = "ï¼ˆæŒ‰ã€Œé–‹å§‹æœ¬å±€ã€å¾Œæœƒå‡ºé¡Œï¼‰";
      feedbackText.textContent = "";
      feedbackText.className = "feedback-text";
      tipText.textContent = "";
      setAnswerLock(false);
    }

    function startGame() {
      if (!state.playerName) { alert("è«‹å…ˆå›åˆ°ç¬¬ä¸€é è¼¸å…¥ç©å®¶åç¨±ã€‚"); return; }
      resetGameValues();
      state.isPlaying = true;
      updateStatusTexts();
      showQuestion();
      startTimer();
    }

    function endGame() {
      if (!state.isPlaying) return;
      state.isPlaying = false;
      stopTimer();
      setAnswerLock(true);
      updateStatusTexts();

      const score = state.score;
      const stars = computeStars(score);
      const lv = levelInfo.find(l => l.id === state.level);
      const sp = speedInfo.find(s => s.id === state.speed);

      resultPlayerName.textContent = state.playerName || "ï¼";
      resultLevelText.textContent = lv ? lv.name : "ï¼";
      resultSpeedText.textContent = sp ? sp.label : "ï¼";
      resultScore.textContent = score;
      resultStars.textContent = stars;

      state.pendingScore = {
        name: state.playerName || "æœªçŸ¥ç©å®¶",
        level: state.level,
        speed: state.speed,
        speedLabel: sp ? sp.label : state.speed,
        score: score,
        stars: stars
      };

      resultOverlay.classList.add("visible");
    }

    btnStartFromIntro.addEventListener("click", () => {
      const name = inputPlayerName.value.trim();
      if (!name) { alert("è«‹è¼¸å…¥ç©å®¶åç¨±å†ç¹¼çºŒã€‚"); inputPlayerName.focus(); return; }
      state.playerName = name;
      updateStatusTexts();
      showPage(2);
    });

    btnBackToIntro.addEventListener("click", () => showPage(1));

    btnGoGame.addEventListener("click", () => {
      if (!state.playerName) { alert("è«‹å…ˆåœ¨ç¬¬ä¸€é è¼¸å…¥ç©å®¶åç¨±ã€‚"); showPage(1); return; }
      showPage(3);
      updateStatusTexts();
      startGame();
    });

    btnRestart.addEventListener("click", () => {
      if (!confirm("ç¢ºå®šè¦é‡æ–°é–‹å§‹æœ¬é—œæœ¬é€Ÿåº¦å—ï¼Ÿç›®å‰åˆ†æ•¸æœƒæ­¸é›¶å–”ã€‚")) return;
      startGame();
    });

    btnPause.addEventListener("click", () => {
      if (!state.isPlaying) return;
      if (!state.isPaused) {
        state.isPaused = true;
        pauseOverlay.classList.add("visible");
      }
    });

    btnResumeFromPause.addEventListener("click", () => {
      state.isPaused = false;
      pauseOverlay.classList.remove("visible");
      if (state.isPlaying && !state.isLocking) answerInput.focus();
    });

    btnBackMenuFromGame.addEventListener("click", () => {
      if (!confirm("ç¢ºå®šè¦çµæŸé€™ä¸€å±€ä¸¦å›é—œå¡ä¸»é¸å–®å—ï¼Ÿæœ¬å±€æˆç¸¾ä¸æœƒå¯«å…¥æ’è¡Œæ¦œã€‚")) return;
      resetGameValues();
      showPage(2);
    });

    btnSubmit.addEventListener("click", checkAnswer);
    answerInput.addEventListener("keydown", e => {
      if (e.key === "Enter") { e.preventDefault(); checkAnswer(); }
    });

    btnSaveScore.addEventListener("click", () => {
      addScoreToLeaderboard(state.pendingScore);
      state.pendingScore = null;
      resultOverlay.classList.remove("visible");
      resetGameValues();
      showPage(2);
    });

    btnCloseResult.addEventListener("click", () => {
      state.pendingScore = null;
      resultOverlay.classList.remove("visible");
      resetGameValues();
      showPage(2);
    });

    initLevelChips();
    initSpeedChips();
    renderLeaderboard();
    updateStatusTexts();
  </script>
</body>
</html>
